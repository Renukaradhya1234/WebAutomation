(()=>{"use strict";var e=function(e,t,n,o){return new(n||(n=Promise))((function(s,a){function i(e){try{c(o.next(e))}catch(e){a(e)}}function r(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,r)}c((o=o.apply(e,t||[])).next())}))},t=function(e,t){var n,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=r(0),i.throw=r(1),i.return=r(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(r){return function(c){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,r[0]&&(a=0)),a;)try{if(n=1,o&&(s=2&r[0]?o.return:r[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,r[1])).done)return s;switch(o=0,s&&(r=[2&r[0],s.value]),r[0]){case 0:case 1:s=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!((s=(s=a.trys).length>0&&s[s.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!s||r[1]>s[0]&&r[1]<s[3])){a.label=r[1];break}if(6===r[0]&&a.label<s[1]){a.label=s[1],s=r;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(r);break}s[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=s=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}};const n=function(){function n(){}return n.prototype.TabAdd=function(n,o){return e(this,void 0,void 0,(function(){return t(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e,t){chrome.tabs.create(n).then((function(t){console.log("New Tab Created:- ",t),o.Status="Success",o.Reason="Tab created",e()})).catch((function(e){console.warn("error:- ",e),o.Status="Failed",o.Reason="Tab Creation Failed",t()}))}))];case 1:return e.sent(),[2]}}))}))},n.prototype.TabUpdate=function(n,o,s){return e(this,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return e={url:n},[4,new Promise((function(t,n){chrome.tabs.query(e).then((function(e){e.length>1&&console.warn("Multiple tabs found...",e),0===e.length&&(s.Status="Failed",s.Reason="No Tab Found for URL...",n());var a=e[0].id;chrome.tabs.update(a,o).then((function(e){console.log("updated...",e),s.Status="Success",s.Reason="Tab Updated sucessful...",t()})).catch((function(e){console.warn("error while updating the URL:- ",e),s.Status="Failed",s.Reason="Failed to update tab URL...",n()}))})).catch((function(e){console.warn("error while find the URL:- ",e),s.Status="Failed",s.Reason="Failed to find the URL...",n()}))}))];case 1:return t.sent(),[2]}}))}))},n.prototype.TabRemove=function(n,o){return e(this,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return e={url:n},[4,new Promise((function(t,n){chrome.tabs.query(e).then((function(e){e.length>0&&console.warn("Multiple tab Found..."),0===e.length&&(o.Status="Failed",o.Reason="No tab found for URL...",n());var s=e[0].id;chrome.tabs.remove(s).then((function(){console.log("removed:- ",e[0]),o.Status="Success",o.Reason="Tab is Removed...",t()})).catch((function(e){console.warn("error:- ",e),o.Status="Failed",o.Reason="Failed to remove the tab...",n()}))})).catch((function(e){console.warn("error:- ",e),o.Status="Failed",o.Reason="Failed to found the URL...",n()}))}))];case 1:return t.sent(),[2]}}))}))},n.prototype.TabReload=function(n,o){return e(this,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return e={url:n},[4,new Promise((function(t,n){chrome.tabs.query(e).then((function(e){if(e.length>1&&console.warn("Multiple tabs Found..."),0===e.length)return o.Status="Failed",o.Reason="No Tab Found for URL...",void n();var s=e[0].id;chrome.tabs.reload(s).then((function(){console.log("reloaded...",e[0]),o.Status="Success",o.Reason="Tab Reloaded Successful...",t()})).catch((function(e){console.warn("error while reloading:- ",e),o.Status="Failed",o.Reason="Failed to Reload tab...",n()}))})).catch((function(e){console.warn("error while founding the tab:- ",e),o.Status="Failed",o.Reason="Failed to Find the tab...",n()}))}))];case 1:return t.sent(),[2]}}))}))},n.prototype.MessageAnalyzer=function(e,t){var n,o,s=e.Operation;if("create"===s){if(""===e.Props.URL)return console.warn("I need URL to create tab...."),t.Status="Failed",void(t.Reason="create tab need URL");var a={url:e.Props.URL,active:null!==(n=e.Props.Active)&&void 0!==n&&n};this.TabAdd(a,t)}else if("update"===s){if(!e.Props.URL&&!e.Props.NewURL)return console.warn("I need URLs to update tab...."),t.Status="Failed",void(t.Reason="For update tab URL is needed...");a={url:e.Props.NewURL,active:null!==(o=e.Props.Active)&&void 0!==o&&o},this.TabUpdate(e.Props.URL,a,t)}else if("remove"===s){if(!e.Props.URL)return console.warn("I need URL to remove the tab...."),t.Status="Failed",void(t.Reason="To remove tab, URL is needed...");this.TabRemove(e.Props.URL,t)}else if("reload"===s){if(!e.Props.URL)return console.warn("I need URL to reload the tab...."),t.Status="Failed",void(t.Reason="To reload, URL is needed...");this.TabReload(e.Props.URL,t)}else console.warn("Invalid Operations:- ",e),t.Status="Failed",t.Reason="Unknown Tab Operation..."},n}();new(function(){function e(){this.NativeHostPort=chrome.runtime.connectNative("com.my_native_host"),this.TabPorts={},this.ActionResponse={ActionId:"",SendTo:"NativeHost",From:"BackgroundJS",Status:"",Reason:""},this.CanISendMessageToNativeHost=!1,this.tabWorker=new n,this.Main()}return e.prototype.SendMessageToNativeHost=function(e){e.SendTo="NativeHost",e.From="BackgroundJS";var t=JSON.stringify(e);console.log("Sending Message to native host:- ",e),this.NativeHostPort.postMessage(t)},e.prototype.SendMessageToContentJS=function(e,t){var n=this,o=this.TabPorts[e];o?(t.From="BackgroundJS",t.SendTo="ContentJS",o.postMessage(t)):(console.log("".concat(e," port is not available... retrying after 3 sec")),setTimeout((function(e,t){n.SendMessageToContentJS(e,t)}),3e3,e,t))},e.prototype.ContentMessageAnalizer=function(e){"ContentJS"===e.From&&"BackgroundJS"===e.SendTo&&e.ActionId===this.ActionResponse.ActionId&&(this.CanISendMessageToNativeHost?console.warn("ContentMessageAnaliyzer: Message May already sent to native host: ",e):(this.CanISendMessageToNativeHost=!0,this.SendMessageToNativeHost(e)))},e.prototype.BindToPort=function(e){var t=this;e.onMessage.addListener((function(e){t.ContentMessageAnalizer(e)})),this.TabPorts["".concat(e.sender.tab.id)]=e},e.prototype.NativeHostMessageAnalyzer=function(e){var t=this;if(console.log("Message received from native Message:- ",e),this.ActionResponse.ActionId=e.ActionId,"BackgroundJS"===e.SendTo){if(this.CanISendMessageToNativeHost||setTimeout((function(){return t.NativeHostMessageInitializer()}),7e3),"NativeHost"===e.From)if("tabs"===e.OperationOn)this.tabWorker.MessageAnalyzer(e,this.ActionResponse);else if("contents"===e.OperationOn)if(e.Props.URL){var n={url:e.Props.URL};this.CanISendMessageToNativeHost=!1,chrome.tabs.query(n).then((function(o){if(o.length>1&&console.warn("Multiple tabs found for URL:- ",n.url),0===o.length)return t.ActionResponse.Status="Failed",t.ActionResponse.Reason="No tabs found for the URL...",void t.SendMessageToNativeHost(t.ActionResponse);var s=o[0].id;t.SendMessageToContentJS("".concat(s),e)})).catch((function(e){console.warn("error while finding the tab:- ",e),t.ActionResponse.Status="Failed",t.ActionResponse.Reason="Error while Finding the tab...",t.SendMessageToNativeHost(t.ActionResponse)}))}else console.warn("I need to URL to perform contents actions..."),this.ActionResponse.Status="Failed",this.ActionResponse.Reason="URL is not given...",this.SendMessageToNativeHost(this.ActionResponse);else console.warn("I don't know this action:- ",e),this.ActionResponse.Status="Failed",this.ActionResponse.Reason="I don't know this action...",this.SendMessageToNativeHost(this.ActionResponse)}else this.ActionResponse.Status="Failed",this.ActionResponse.Reason="This message is not for me!...",this.SendMessageToNativeHost(this.ActionResponse)},e.prototype.NativeHostMessageInitializer=function(){this.CanISendMessageToNativeHost?console.warn("NativeMessageInitializer: Message may already sent to Native host: ",this.ActionResponse):(this.ActionResponse.Status="Failed",this.ActionResponse.Reason="Time Out...",this.CanISendMessageToNativeHost=!0,this.SendMessageToNativeHost(this.ActionResponse))},e.prototype.Main=function(){var e=this;this.NativeHostPort.onMessage.addListener((function(t){e.NativeHostMessageAnalyzer(t)})),this.NativeHostPort.onDisconnect.addListener((function(){console.log("Native Host is disconnected...")})),chrome.runtime.onConnect.addListener((function(t){e.BindToPort(t)})),console.log("Background JS is Running...")},e}())})();
//# sourceMappingURL=background.min.js.map